import "dotenv/config";
import { embedText } from "../src/ai/embeddings.js";
import { supabase } from "../src/db/supabase.js";

const lessons = [
  // ================= Forex Basics =================
  {
    lesson_id: "forex_intro",
    module: "Forex Basics",
    content: `Forex гэдэг нь Foreign Exchange буюу валют солилцооны зах зээл юм. Энэ зах зээл дээр улс орнуудын валютууд хоорондоо арилжаалагддаг бөгөөд дэлхийн хамгийн том санхүүгийн зах зээлд тооцогддог. Өдөр бүр хэдэн их наяд долларын арилжаа Forex дээр хийгддэг.

Forex зах зээл нь төвлөрсөн биржгүй, дэлхий даяар тархсан OTC зах зээл юм. Арилжаа нь банкууд, санхүүгийн байгууллагууд, брокерууд болон хувь трейдерүүдийн хооронд явагдана. Ийм бүтэцтэй тул зах зээл үргэлж нээлттэй байдаг.

Forex зах зээл 24 цаг, долоо хоногт 5 өдөр ажилладаг. Азийн, Европын, Америкийн зах зээлүүд ээлжлэн нээгддэг учраас трейдер хүссэн цагтаа арилжаа хийх боломжтой.

Forex дээр арилжаа хийхдээ нэг валютыг худалдан авч, нөгөөг зарах замаар ханшийн өөрчлөлтөөс ашиг олохыг зорьдог.`
  },
  {
    lesson_id: "market_participants",
    module: "Forex Basics",
    content: `Forex зах зээлд олон төрлийн оролцогчид байдаг. Хамгийн том оролцогчид нь төв банкууд бөгөөд валютын ханшид бодлогын түвшинд нөлөөлдөг. Мөн арилжааны банкууд, хөрөнгө оруулалтын сангууд зах зээлийн үндсэн хөдөлгөгч хүч болдог.

Брокерууд нь жижиг болон дунд трейдерүүдийг зах зээлтэй холбож өгдөг зуучлагчид юм. Харин retail трейдерүүд нь хувь хүмүүс бөгөөд зах зээлийн жижиг хэсгийг бүрдүүлдэг.

Эдгээр оролцогчид өөр өөр зорилготой байдаг. Зарим нь валютын нөөц удирдах, зарим нь ашиг олох, зарим нь эрсдэл хеджлэх зорилготой оролцдог.

Зах зээлийн оролцогчдыг ойлгосноор ханш яагаад хөдөлж байгааг илүү бодитойгоор тайлбарлах боломжтой болдог.`
  },
  {
    lesson_id: "trading_sessions",
    module: "Forex Basics",
    content: `Forex зах зээл үндсэндээ Азийн, Европын, Америкийн гэсэн гурван арилжааны сесситэй. Азийн сесс Токио төвтэйгээр эхэлдэг бол Европын сесс Лондонгоор дамжин идэвхждэг. Америкийн сесс Нью-Йоркт төвлөрдөг.

Эдгээр сессүүд давхацсан үед зах зээлийн идэвх болон хэлбэлзэл ихэсдэг. Ялангуяа Европ болон Америкийн сесс давхцах үед ихэнх том хөдөлгөөнүүд гардаг.

Зарим валютын хос тодорхой сессэд илүү идэвхтэй байдаг. Жишээ нь JPY Азийн сессэд, EUR Европын сессэд идэвхтэй хөдөлдөг.

Арилжааны цагийг зөв сонгох нь стратегийн нэг хэсэг бөгөөд зах зээлийн хэлбэлзлийг зөв ашиглахад тусалдаг.`
  },

  // ================= Market Mechanics =================
  {
    lesson_id: "currency_pairs",
    module: "Market Mechanics",
    content: `Валютын хос гэдэг нь хоёр валютын харьцааг илэрхийлдэг ойлголт юм. Forex зах зээл дээр бүх арилжаа валютын хосоор хийгддэг. Жишээ нь EUR/USD гэдэг нь евро болон америк долларын харьцаа юм.

Валютын хос нь base валют болон quote валют гэсэн хоёр хэсэгтэй. Base валют нь эхэнд бичигддэг бөгөөд quote валют нь хоёр дахьд ордог. Ханш нь base валютын нэгж хэдэн quote валюттай тэнцүүг илэрхийлдэг.

Валютын хосуудыг major, minor, exotic гэж ангилдаг. Major хосууд нь хамгийн их арилжаалагддаг бөгөөд хэлбэлзэл, зардал багатай байдаг.

Валютын хосын бүтэц, ангиллыг ойлгох нь Forex арилжааны суурь мэдлэг юм.`
  },
  {
    lesson_id: "bid_ask",
    module: "Market Mechanics",
    content: `Bid болон Ask гэдэг нь Forex зах зээл дээрх үнийн үндсэн ойлголтууд юм. Bid үнэ нь брокер валютыг худалдан авахад бэлэн байгаа үнэ, Ask үнэ нь валютыг зарах үнэ юм.

Ask үнэ нь үргэлж Bid-ээс өндөр байдаг. Энэ зөрүүг spread гэж нэрлэдэг. Трейдер арилжаа нээх үедээ энэ зардлыг автоматаар төлдөг.

Bid болон Ask үнийг ойлгох нь оролт, гаралтыг зөв тооцоолоход чухал. Ялангуяа богино хугацааны арилжаанд энэ ялгаа илүү мэдрэгддэг.

Үнэ яагаад хоёр өөр байдаг вэ гэдгийг ойлгосноор трейдер зах зээлийн механизмыг илүү сайн ойлгож эхэлдэг.`
  },
  {
    lesson_id: "spread",
    module: "Market Mechanics",
    content: `Spread гэдэг нь Bid болон Ask үнийн зөрүү юм. Энэ нь брокерийн орлого бөгөөд трейдерийн төлдөг үндсэн арилжааны зардалд тооцогдоно.

Зах зээл идэвхтэй үед spread багасч, сул үед нэмэгдэх хандлагатай. Томоохон мэдээний үед spread огцом тэлэх тохиолдол бий.

Scalping болон short-term арилжаанд spread маш чухал нөлөөтэй. Spread өндөр байвал богино хугацаанд ашиг олох хүндрэлтэй болдог.

Тиймээс трейдерүүд бага spread-тэй валютын хос, найдвартай брокер сонгохыг эрмэлздэг.`
  },
  {
    lesson_id: "pip_lot",
    module: "Market Mechanics",
    content: `Pip гэдэг нь валютын ханшийн хамгийн бага өөрчлөлтийг илэрхийлэх нэгж юм. Ихэнх валютын хосын хувьд 1 pip нь 0.0001 хэмжээтэй байдаг. JPY оролцсон хосын хувьд pip нь 0.01 байна.

Lot гэдэг нь арилжааны хэмжээ буюу валютын тоо хэмжээг илэрхийлнэ. Стандарт lot нь 100,000 нэгж валюттай тэнцүү. Мөн mini болон micro lot гэсэн ойлголтууд бий.

Pip болон lot нь ашгийн болон алдагдлын хэмжээг тодорхойлдог гол хүчин зүйлс юм. Эдгээрийг ойлгох нь эрсдэлийг зөв удирдахад зайлшгүй шаардлагатай.

Эхлэгч трейдерүүд ихэвчлэн бага lot ашиглан дадлага хийхийг зөвлөдөг.`
  },

  // ================= Trading Operations =================
  {
    lesson_id: "buy_sell",
    module: "Trading Operations",
    content: `Buy болон Sell гэдэг нь Forex арилжааны үндсэн хоёр үйлдэл юм. Buy хийх нь ханш өснө гэж таамаглан арилжаа нээхийг хэлдэг бол Sell нь ханш унана гэж үзэхийг илэрхийлнэ.

Forex зах зээл нь уналтаас ч ашиг олох боломж олгодог нь бусад зах зээлээс ялгаатай онцлог юм. Тиймээс трейдер зах зээлийн чиглэлийг зөв таамаглах нь чухал.

Buy болон Sell шийдвэр нь анализ дээр суурилсан байх ёстой. Сэтгэл хөдлөлөөр хийсэн шийдвэр ихэвчлэн алдагдалд хүргэдэг.

Зөв оролт хийх нь амжилттай арилжааны эхлэл болдог.`
  },
  {
    lesson_id: "order_types",
    module: "Trading Operations",
    content: `Order types гэдэг нь арилжаа нээх болон хаах арга хэлбэрүүд юм. Market order нь тухайн агшны үнээр шууд гүйцэтгэгддэг.

Limit order нь илүү ашигтай үнээр орох зорилготой байдаг бол Stop order нь тодорхой нөхцөл биелэхэд идэвхждэг.

Order types-ийг зөв ашигласнаар трейдер зах зээлийг байнга ажиглах шаардлагагүй болдог. Энэ нь цаг болон сэтгэлзүйн ачааллыг бууруулдаг.

Төлөвлөгөөтэй арилжаанд order types чухал үүрэгтэй.`
  },
  {
    lesson_id: "sl_tp",
    module: "Trading Operations",
    content: `Stop Loss болон Take Profit нь эрсдэлийг удирдах үндсэн хэрэгслүүд юм. Stop Loss нь алдагдлыг урьдчилан тогтоосон түвшинд хязгаарладаг.

Take Profit нь ашиг тодорхой хэмжээнд хүрэхэд арилжааг автоматаар хаадаг. Энэ нь сэтгэл хөдлөлөөс ангид байх боломж олгодог.

Эдгээрийг ашиглахгүй арилжаа хийх нь дансны эрсдэлийг огцом нэмэгдүүлдэг. Тиймээс мэргэжлийн трейдерүүд заавал ашигладаг.

Stop Loss болон Take Profit нь сахилга баттай арилжааны үндэс юм.`
  },

  // ================= Risk Management =================
  {
    lesson_id: "risk_intro",
    module: "Risk Management",
    content: `Risk буюу эрсдэл гэдэг нь арилжаанд алдагдал хүлээх магадлал юм. Forex зах зээл өндөр боломжтой ч өндөр эрсдэлтэй байдаг.

Ихэнх эхлэгчид ашигт хэт анхаарч, эрсдэлийг үл тоодог. Харин амжилттай трейдерүүд эхлээд алдагдлаа хамгаалдаг.

Эрсдэлийг удирдах нь урт хугацаанд зах зээлд үлдэх үндэс болдог. Ашиг дараа нь дагалдаж ирдэг.

Risk management бол стратеги биш, заавал мөрдөх дүрэм юм.`
  },
  {
    lesson_id: "position_sizing",
    module: "Risk Management",
    content: `Position sizing гэдэг нь нэг арилжаанд орох хэмжээг тодорхойлох үйл явц юм. Энэ нь дансны хэмжээнд тохирсон байх ёстой.

Нэг арилжаанд нийт дансны 1–2 хувиас илүү эрсдэл гаргахгүй байх нь түгээмэл зарчим юм. Энэ нь дараалсан алдагдлаас хамгаалдаг.

Зөв position sizing нь трейдерийг сэтгэлзүйн дарамтаас салгаж, төлөвлөгөөндөө үнэнч байхад тусалдаг.

Урт хугацааны амжилтын гол түлхүүр нь зөв хэмжээ юм.`
  },
  {
    lesson_id: "leverage_margin",
    module: "Risk Management",
    content: `Leverage нь бага хөрөнгөөр их хэмжээний арилжаа хийх боломж олгодог хэрэгсэл юм. Харин Margin нь брокерт барьцаалж буй мөнгө юм.

Leverage ашиглах нь ашгийг нэмэгдүүлж болох ч адил хэмжээгээр алдагдлыг ч өсгөдөг. Тиймээс болгоомжтой хэрэглэх шаардлагатай.

Их leverage нь эхлэгч трейдерүүдийн хамгийн том алдаа болдог. Бага leverage нь илүү тогтвортой арилжаанд тусалдаг.

Leverage бол боломж ч бас аюул юм.`
  },

  // ================= Psychology =================
  {
    lesson_id: "trading_emotions",
    module: "Psychology & Discipline",
    content: `Forex арилжаанд сэтгэлзүй маш чухал үүрэгтэй. Айдас, шунал, уур зэрэг сэтгэл хөдлөл буруу шийдвэр гаргахад хүргэдэг.

Алдагдлын дараа өшөө авах арилжаа хийх нь түгээмэл алдаа юм. Энэ нь ихэвчлэн илүү том алдагдалд хүргэдэг.

Сэтгэлзүйгээ удирдаж чаддаг трейдерүүд зах зээлийн дарамтад авталгүй төлөвлөгөөгөө баримталдаг.

Сэтгэл хөдлөлөө таних нь амжилттай арилжааны эхлэл юм.`
  },
  {
    lesson_id: "overtrading",
    module: "Psychology & Discipline",
    content: `Overtrading гэдэг нь хэт олон арилжаа хийхийг хэлнэ. Энэ нь ихэвчлэн уйдалт, алдагдлаа нөхөх оролдлогоос үүдэлтэй байдаг.

Overtrading нь сэтгэлзүйн ядаргаа, алдаа нэмэгдэх шалтгаан болдог. Мөн зардлыг өсгөж, ашгийг багасгадаг.

Чанартай цөөн арилжаа нь олон муу арилжаанаас илүү үр дүнтэй. Зах зээлийг заавал өдөр бүр арилжаалах шаардлагагүй.

Амрах чадвар бол трейдерийн нэг чадвар юм.`
  },
  {
    lesson_id: "trading_plan",
    module: "Psychology & Discipline",
    content: `Trading plan гэдэг нь арилжаанд баримтлах дүрэм, стратегийн нэгдэл юм. Үүнд оролт, гаралт, эрсдэлийн хэмжээ, арилжааны цаг багтдаг.

Төлөвлөгөөгүй арилжаа нь сэтгэл хөдлөлд автдаг. Харин төлөвлөгөөтэй трейдер шийдвэрээ урьдчилан гаргасан байдаг.

Trading plan-аа тууштай мөрдөх нь амжилтын үндэс юм. Зах зээлийн нөхцөл өөрчлөгдөхөд ч төлөвлөгөө хамгаалалт болдог.

Төгс стратеги бус, тууштай хэрэгжилт амжилт авчирдаг.`
  }
];

async function ingest() {
  for (const lesson of lessons) {
    const embedding = await embedText(lesson.content);

    await supabase.from("docs").insert({
      content: lesson.content,
      embedding,
      metadata: {
        lesson_id: lesson.lesson_id,
        module: lesson.module,
        source: "forex_curriculum_v1",
        lang: "mn"
      }
    });

    console.log(`✅ Inserted: ${lesson.lesson_id}`);
  }
}

ingest();
